{"ast":null,"code":"import axios from \"axios\";\nconst API_URL = \"https://api.kit.com/v4/broadcasts\";\nconst API_KEY = \"kit_a0a183e8fd744ca557d96126e488ae22\";\nconst headers = {\n  Accept: \"application/json\",\n  \"Content-Type\": \"application/json\",\n  \"X-Kit-Api-Key\": API_KEY\n};\nfunction buildEmailBody(product) {\n  // Extract all product fields with defaults\n  const title = (product.title || \"\").trim();\n  const imageUrl = product.image_url || \"\";\n  const amazonUrl = product.amazon_url || \"\";\n  const walmartUrl = product.walmart_url || \"\";\n  const ebayUrl = product.ebay_url || \"\";\n  const price = product.price ? parseFloat(product.price).toFixed(2) : \"0.00\";\n  const moq = product.moq || \"0\";\n  const qty = product.qty || \"0\";\n  const asin = product.asin || \"\";\n  const fob = product.fob || \"\";\n  const expDate = product.exp_date || \"\";\n  let leadTime = product.lead_time || \"\";\n\n  // Modify lead time display\n  if (leadTime.includes(\"Days\")) {\n    leadTime = leadTime.replace(\"Days\", \"Business Days\");\n  }\n\n  // EXACT replica of Python formatting with embedded styles\n  return `\n    <html>\n      <head>\n        <style>\n          body { \n            font-family: Arial, sans-serif; \n            text-align: center; \n            margin: 0;\n            padding: 20px 0;\n          }\n          .product-container {\n            margin-bottom: 60px;\n          }\n          .product-title {\n            font-size: 18px;\n            margin-bottom: 20px;\n          }\n          .product-image {\n            max-width: 300px;\n            max-height: 300px;\n            width: auto;\n            height: auto;\n            object-fit: contain;\n            display: block;\n            margin: 40px auto;\n          }\n          .button {\n            padding: 15px 25px;\n            font-size: 16px;\n            text-decoration: none;\n            border-radius: 5px;\n            margin: 5px;\n            display: inline-block;\n            color: white;\n          }\n          .amazon { background-color: #FF9900; }\n          .walmart { background-color: #0071CE; }\n          .ebay { background-color: #E53238; }\n          .details {\n            font-size: 18px;\n            margin: 10px 0;\n          }\n        </style>\n      </head>\n      <body>\n        <div class=\"product-container\">\n          <h2 class=\"product-title\">${title}</h2>\n          <img class=\"product-image\" src=\"${imageUrl}\" alt=\"${title}\" />\n\n          <div class=\"button-container\">\n            ${amazonUrl.includes(\"https\") ? `<a class=\"button amazon\" href=\"${amazonUrl}\">Amazon Link</a>` : ''}\n            ${walmartUrl.includes(\"https\") ? `<a class=\"button walmart\" href=\"${walmartUrl}\">Walmart Link</a>` : ''}\n            ${ebayUrl.includes(\"https\") ? `<a class=\"button ebay\" href=\"${ebay_url}\">eBay Link</a>` : ''}\n          </div>\n\n          <p class=\"details\">$${price} EA, MOQ ${moq}, ${qty} Available.</p>\n          ${asin ? `<p class=\"details\">ASIN: ${asin}</p>` : ''}\n          ${fob ? `<p class=\"details\">FOB: ${fob}</p>` : ''}\n          ${expDate ? `<p class=\"details\">Expiration Date: ${expDate}</p>` : ''}\n          <p class=\"details\">Lead Time: ${leadTime}</p>\n        </div>\n      </body>\n    </html>\n  `;\n}\nexport async function sendIndividualEmails(selectedProducts) {\n  if (!(selectedProducts !== null && selectedProducts !== void 0 && selectedProducts.length)) {\n    console.error(\"No products selected\");\n    return;\n  }\n  for (const product of selectedProducts) {\n    if (!(product !== null && product !== void 0 && product.title)) {\n      console.error(\"Invalid product:\", product);\n      continue;\n    }\n    try {\n      const response = await axios.post(API_URL, {\n        subject: product.title,\n        content: buildEmailBody(product),\n        public: false,\n        email_template_id: null\n      }, {\n        headers\n      });\n      if (response.status === 201) {\n        console.log(`Draft created: ${product.title}`);\n        // Add last_sent update here if needed\n      } else {\n        console.error(`Failed for ${product.title}:`, response.data);\n      }\n    } catch (error) {\n      console.error(`Error with ${product.title}:`, error);\n    }\n  }\n}\nexport async function sendGroupEmail(selectedProducts) {\n  if (!(selectedProducts !== null && selectedProducts !== void 0 && selectedProducts.length)) {\n    console.error(\"No products selected\");\n    return;\n  }\n  try {\n    const response = await axios.post(API_URL, {\n      subject: `Group Deal: ${selectedProducts.length} Products Available!`,\n      content: selectedProducts.map(p => buildEmailBody(p)).join(\"<hr>\"),\n      public: false,\n      email_template_id: null\n    }, {\n      headers\n    });\n    if (response.status === 201) {\n      console.log(\"Group draft created\");\n      // Add last_sent updates here if needed\n    } else {\n      console.error(\"Group failed:\", response.data);\n    }\n  } catch (error) {\n    console.error(\"Group error:\", error);\n  }\n}","map":{"version":3,"names":["axios","API_URL","API_KEY","headers","Accept","buildEmailBody","product","title","trim","imageUrl","image_url","amazonUrl","amazon_url","walmartUrl","walmart_url","ebayUrl","ebay_url","price","parseFloat","toFixed","moq","qty","asin","fob","expDate","exp_date","leadTime","lead_time","includes","replace","sendIndividualEmails","selectedProducts","length","console","error","response","post","subject","content","public","email_template_id","status","log","data","sendGroupEmail","map","p","join"],"sources":["C:/Users/josep/Documents/NPP_Deals/frontend/src/emailSender.js"],"sourcesContent":["import axios from \"axios\";\r\n\r\nconst API_URL = \"https://api.kit.com/v4/broadcasts\";\r\nconst API_KEY = \"kit_a0a183e8fd744ca557d96126e488ae22\";\r\n\r\nconst headers = {\r\n  Accept: \"application/json\",\r\n  \"Content-Type\": \"application/json\",\r\n  \"X-Kit-Api-Key\": API_KEY,\r\n};\r\n\r\nfunction buildEmailBody(product) {\r\n  // Extract all product fields with defaults\r\n  const title = (product.title || \"\").trim();\r\n  const imageUrl = product.image_url || \"\";\r\n  const amazonUrl = product.amazon_url || \"\";\r\n  const walmartUrl = product.walmart_url || \"\";\r\n  const ebayUrl = product.ebay_url || \"\";\r\n  const price = product.price ? parseFloat(product.price).toFixed(2) : \"0.00\";\r\n  const moq = product.moq || \"0\";\r\n  const qty = product.qty || \"0\";\r\n  const asin = product.asin || \"\";\r\n  const fob = product.fob || \"\";\r\n  const expDate = product.exp_date || \"\";\r\n  let leadTime = product.lead_time || \"\";\r\n\r\n  // Modify lead time display\r\n  if (leadTime.includes(\"Days\")) {\r\n    leadTime = leadTime.replace(\"Days\", \"Business Days\");\r\n  }\r\n\r\n  // EXACT replica of Python formatting with embedded styles\r\n  return `\r\n    <html>\r\n      <head>\r\n        <style>\r\n          body { \r\n            font-family: Arial, sans-serif; \r\n            text-align: center; \r\n            margin: 0;\r\n            padding: 20px 0;\r\n          }\r\n          .product-container {\r\n            margin-bottom: 60px;\r\n          }\r\n          .product-title {\r\n            font-size: 18px;\r\n            margin-bottom: 20px;\r\n          }\r\n          .product-image {\r\n            max-width: 300px;\r\n            max-height: 300px;\r\n            width: auto;\r\n            height: auto;\r\n            object-fit: contain;\r\n            display: block;\r\n            margin: 40px auto;\r\n          }\r\n          .button {\r\n            padding: 15px 25px;\r\n            font-size: 16px;\r\n            text-decoration: none;\r\n            border-radius: 5px;\r\n            margin: 5px;\r\n            display: inline-block;\r\n            color: white;\r\n          }\r\n          .amazon { background-color: #FF9900; }\r\n          .walmart { background-color: #0071CE; }\r\n          .ebay { background-color: #E53238; }\r\n          .details {\r\n            font-size: 18px;\r\n            margin: 10px 0;\r\n          }\r\n        </style>\r\n      </head>\r\n      <body>\r\n        <div class=\"product-container\">\r\n          <h2 class=\"product-title\">${title}</h2>\r\n          <img class=\"product-image\" src=\"${imageUrl}\" alt=\"${title}\" />\r\n\r\n          <div class=\"button-container\">\r\n            ${amazonUrl.includes(\"https\") ? \r\n              `<a class=\"button amazon\" href=\"${amazonUrl}\">Amazon Link</a>` : ''}\r\n            ${walmartUrl.includes(\"https\") ? \r\n              `<a class=\"button walmart\" href=\"${walmartUrl}\">Walmart Link</a>` : ''}\r\n            ${ebayUrl.includes(\"https\") ? \r\n              `<a class=\"button ebay\" href=\"${ebay_url}\">eBay Link</a>` : ''}\r\n          </div>\r\n\r\n          <p class=\"details\">$${price} EA, MOQ ${moq}, ${qty} Available.</p>\r\n          ${asin ? `<p class=\"details\">ASIN: ${asin}</p>` : ''}\r\n          ${fob ? `<p class=\"details\">FOB: ${fob}</p>` : ''}\r\n          ${expDate ? `<p class=\"details\">Expiration Date: ${expDate}</p>` : ''}\r\n          <p class=\"details\">Lead Time: ${leadTime}</p>\r\n        </div>\r\n      </body>\r\n    </html>\r\n  `;\r\n}\r\n\r\nexport async function sendIndividualEmails(selectedProducts) {\r\n  if (!selectedProducts?.length) {\r\n    console.error(\"No products selected\");\r\n    return;\r\n  }\r\n\r\n  for (const product of selectedProducts) {\r\n    if (!product?.title) {\r\n      console.error(\"Invalid product:\", product);\r\n      continue;\r\n    }\r\n\r\n    try {\r\n      const response = await axios.post(API_URL, {\r\n        subject: product.title,\r\n        content: buildEmailBody(product),\r\n        public: false,\r\n        email_template_id: null\r\n      }, { headers });\r\n\r\n      if (response.status === 201) {\r\n        console.log(`Draft created: ${product.title}`);\r\n        // Add last_sent update here if needed\r\n      } else {\r\n        console.error(`Failed for ${product.title}:`, response.data);\r\n      }\r\n    } catch (error) {\r\n      console.error(`Error with ${product.title}:`, error);\r\n    }\r\n  }\r\n}\r\n\r\nexport async function sendGroupEmail(selectedProducts) {\r\n  if (!selectedProducts?.length) {\r\n    console.error(\"No products selected\");\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const response = await axios.post(API_URL, {\r\n      subject: `Group Deal: ${selectedProducts.length} Products Available!`,\r\n      content: selectedProducts.map(p => buildEmailBody(p)).join(\"<hr>\"),\r\n      public: false,\r\n      email_template_id: null\r\n    }, { headers });\r\n\r\n    if (response.status === 201) {\r\n      console.log(\"Group draft created\");\r\n      // Add last_sent updates here if needed\r\n    } else {\r\n      console.error(\"Group failed:\", response.data);\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Group error:\", error);\r\n  }\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}