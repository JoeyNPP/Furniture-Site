{"ast":null,"code":"import axios from \"axios\";\nconst API_URL = \"https://api.kit.com/v4/broadcasts\";\nconst API_KEY = \"kit_a0a183e8fd744ca557d96126e488ae22\";\nconst headers = {\n  Accept: \"application/json\",\n  \"Content-Type\": \"application/json\",\n  \"X-Kit-Api-Key\": API_KEY\n};\n\n// ✅ Send Individual Emails\nexport async function sendIndividualEmails(selectedProducts) {\n  if (!selectedProducts || selectedProducts.length === 0) {\n    console.error(\"No products selected for individual email.\");\n    return;\n  }\n  for (const product of selectedProducts) {\n    if (!product || !product.title) {\n      console.error(\"Skipping invalid product:\", product);\n      continue;\n    }\n    const emailData = {\n      subject: product.title,\n      content: buildEmailBody(product),\n      // ✅ Matches Python formatting\n      public: false,\n      email_template_id: null\n    };\n    try {\n      const response = await axios.post(API_URL, emailData, {\n        headers\n      });\n      if (response.status === 201) {\n        console.log(`Email draft created for: ${product.title}`);\n      } else {\n        console.error(`Failed to send email for ${product.title}:`, response.data);\n      }\n    } catch (error) {\n      console.error(`Error sending email for ${(product === null || product === void 0 ? void 0 : product.title) || \"undefined\"}:`, error);\n    }\n  }\n}\n\n// ✅ Send Group Email\nexport async function sendGroupEmail(selectedProducts) {\n  if (!selectedProducts || selectedProducts.length === 0) {\n    console.error(\"No products selected for group email.\");\n    return;\n  }\n  const emailData = {\n    subject: `Group Deal: ${selectedProducts.length} Products Available!`,\n    content: selectedProducts.map(buildEmailBody).join(\"<hr>\"),\n    public: false,\n    email_template_id: null\n  };\n  try {\n    const response = await axios.post(API_URL, emailData, {\n      headers\n    });\n    if (response.status === 201) {\n      console.log(\"Group email draft created successfully.\");\n    } else {\n      console.error(\"Failed to send group email:\", response.data);\n    }\n  } catch (error) {\n    console.error(\"Error sending group email:\", error);\n  }\n}\n\n// ✅ Build the Email Body EXACTLY Like Python Code\nfunction buildEmailBody(product) {\n  const title = (product.title || \"\").trim();\n  const imageUrl = product.image_url || \"\";\n  const amazonUrl = product.amazon_url || \"\";\n  const walmartUrl = product.walmart_url || \"\";\n  const ebayUrl = product.ebay_url || \"\";\n  const price = product.price ? parseFloat(product.price).toFixed(2) : \"0.00\";\n  const moq = product.moq || \"0\";\n  const qty = product.qty || \"0\";\n  const asin = product.asin || \"\";\n  const fob = product.fob || \"\";\n  const expDate = product.exp_date || \"\";\n  let leadTime = product.lead_time || \"\";\n  if (leadTime.includes(\"Days\")) {\n    leadTime = leadTime.replace(\"Days\", \"Business Days\");\n  }\n\n  // ✅ Embedding <style> to prevent Kit from stripping formatting\n  let emailBody = `\n    <html>\n      <head>\n        <style>\n          body { font-family: Arial, sans-serif; text-align: center; }\n          .container { padding: 20px; }\n          .product-title { font-size: 18px; margin-bottom: 20px; }\n          .product-image { max-width: 300px; max-height: 300px; object-fit: contain; margin: 40px auto; display: block; }\n          .button { padding: 15px 25px; font-size: 16px; text-decoration: none; border-radius: 5px; margin: 5px; display: inline-block; color: white; }\n          .amazon { background-color: #FF9900; }\n          .walmart { background-color: #0071CE; }\n          .ebay { background-color: #E53238; }\n        </style>\n      </head>\n      <body>\n        <div class=\"container\">\n          <h2 class=\"product-title\">${title}</h2>\n          <img class=\"product-image\" src=\"${imageUrl}\" alt=\"${title}\" />\n\n          ${amazonUrl.includes(\"https\") ? `<a class=\"button amazon\" href=\"${amazonUrl}\">Amazon Link</a>` : \"\"}\n          ${walmartUrl.includes(\"https\") ? `<a class=\"button walmart\" href=\"${walmartUrl}\">Walmart Link</a>` : \"\"}\n          ${ebayUrl.includes(\"https\") ? `<a class=\"button ebay\" href=\"${ebayUrl}\">eBay Link</a>` : \"\"}\n          \n          <p>$${price} EA, MOQ ${moq}, ${qty} Available.</p>\n          ${asin ? `<p>ASIN: ${asin}</p>` : \"\"}\n          ${fob ? `<p>FOB: ${fob}</p>` : \"\"}\n          ${expDate ? `<p>Expiration Date: ${expDate}</p>` : \"\"}\n          <p>Lead Time: ${leadTime}</p>\n        </div>\n      </body>\n    </html>\n  `;\n  return emailBody;\n}","map":{"version":3,"names":["axios","API_URL","API_KEY","headers","Accept","sendIndividualEmails","selectedProducts","length","console","error","product","title","emailData","subject","content","buildEmailBody","public","email_template_id","response","post","status","log","data","sendGroupEmail","map","join","trim","imageUrl","image_url","amazonUrl","amazon_url","walmartUrl","walmart_url","ebayUrl","ebay_url","price","parseFloat","toFixed","moq","qty","asin","fob","expDate","exp_date","leadTime","lead_time","includes","replace","emailBody"],"sources":["C:/Users/josep/Documents/NPP_Deals/frontend/src/emailSender.js"],"sourcesContent":["import axios from \"axios\";\r\n\r\nconst API_URL = \"https://api.kit.com/v4/broadcasts\";\r\nconst API_KEY = \"kit_a0a183e8fd744ca557d96126e488ae22\";\r\n\r\nconst headers = {\r\n  Accept: \"application/json\",\r\n  \"Content-Type\": \"application/json\",\r\n  \"X-Kit-Api-Key\": API_KEY,\r\n};\r\n\r\n// ✅ Send Individual Emails\r\nexport async function sendIndividualEmails(selectedProducts) {\r\n  if (!selectedProducts || selectedProducts.length === 0) {\r\n    console.error(\"No products selected for individual email.\");\r\n    return;\r\n  }\r\n\r\n  for (const product of selectedProducts) {\r\n    if (!product || !product.title) {\r\n      console.error(\"Skipping invalid product:\", product);\r\n      continue;\r\n    }\r\n\r\n    const emailData = {\r\n      subject: product.title,\r\n      content: buildEmailBody(product),  // ✅ Matches Python formatting\r\n      public: false,\r\n      email_template_id: null,\r\n    };\r\n\r\n    try {\r\n      const response = await axios.post(API_URL, emailData, { headers });\r\n      if (response.status === 201) {\r\n        console.log(`Email draft created for: ${product.title}`);\r\n      } else {\r\n        console.error(`Failed to send email for ${product.title}:`, response.data);\r\n      }\r\n    } catch (error) {\r\n      console.error(`Error sending email for ${product?.title || \"undefined\"}:`, error);\r\n    }\r\n  }\r\n}\r\n\r\n// ✅ Send Group Email\r\nexport async function sendGroupEmail(selectedProducts) {\r\n  if (!selectedProducts || selectedProducts.length === 0) {\r\n    console.error(\"No products selected for group email.\");\r\n    return;\r\n  }\r\n\r\n  const emailData = {\r\n    subject: `Group Deal: ${selectedProducts.length} Products Available!`,\r\n    content: selectedProducts.map(buildEmailBody).join(\"<hr>\"),\r\n    public: false,\r\n    email_template_id: null,\r\n  };\r\n\r\n  try {\r\n    const response = await axios.post(API_URL, emailData, { headers });\r\n    if (response.status === 201) {\r\n      console.log(\"Group email draft created successfully.\");\r\n    } else {\r\n      console.error(\"Failed to send group email:\", response.data);\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Error sending group email:\", error);\r\n  }\r\n}\r\n\r\n// ✅ Build the Email Body EXACTLY Like Python Code\r\nfunction buildEmailBody(product) {\r\n  const title = (product.title || \"\").trim();\r\n  const imageUrl = product.image_url || \"\";\r\n  const amazonUrl = product.amazon_url || \"\";\r\n  const walmartUrl = product.walmart_url || \"\";\r\n  const ebayUrl = product.ebay_url || \"\";\r\n  const price = product.price ? parseFloat(product.price).toFixed(2) : \"0.00\";\r\n  const moq = product.moq || \"0\";\r\n  const qty = product.qty || \"0\";\r\n  const asin = product.asin || \"\";\r\n  const fob = product.fob || \"\";\r\n  const expDate = product.exp_date || \"\";\r\n  let leadTime = product.lead_time || \"\";\r\n\r\n  if (leadTime.includes(\"Days\")) {\r\n    leadTime = leadTime.replace(\"Days\", \"Business Days\");\r\n  }\r\n\r\n  // ✅ Embedding <style> to prevent Kit from stripping formatting\r\n  let emailBody = `\r\n    <html>\r\n      <head>\r\n        <style>\r\n          body { font-family: Arial, sans-serif; text-align: center; }\r\n          .container { padding: 20px; }\r\n          .product-title { font-size: 18px; margin-bottom: 20px; }\r\n          .product-image { max-width: 300px; max-height: 300px; object-fit: contain; margin: 40px auto; display: block; }\r\n          .button { padding: 15px 25px; font-size: 16px; text-decoration: none; border-radius: 5px; margin: 5px; display: inline-block; color: white; }\r\n          .amazon { background-color: #FF9900; }\r\n          .walmart { background-color: #0071CE; }\r\n          .ebay { background-color: #E53238; }\r\n        </style>\r\n      </head>\r\n      <body>\r\n        <div class=\"container\">\r\n          <h2 class=\"product-title\">${title}</h2>\r\n          <img class=\"product-image\" src=\"${imageUrl}\" alt=\"${title}\" />\r\n\r\n          ${amazonUrl.includes(\"https\") ? `<a class=\"button amazon\" href=\"${amazonUrl}\">Amazon Link</a>` : \"\"}\r\n          ${walmartUrl.includes(\"https\") ? `<a class=\"button walmart\" href=\"${walmartUrl}\">Walmart Link</a>` : \"\"}\r\n          ${ebayUrl.includes(\"https\") ? `<a class=\"button ebay\" href=\"${ebayUrl}\">eBay Link</a>` : \"\"}\r\n          \r\n          <p>$${price} EA, MOQ ${moq}, ${qty} Available.</p>\r\n          ${asin ? `<p>ASIN: ${asin}</p>` : \"\"}\r\n          ${fob ? `<p>FOB: ${fob}</p>` : \"\"}\r\n          ${expDate ? `<p>Expiration Date: ${expDate}</p>` : \"\"}\r\n          <p>Lead Time: ${leadTime}</p>\r\n        </div>\r\n      </body>\r\n    </html>\r\n  `;\r\n\r\n  return emailBody;\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}